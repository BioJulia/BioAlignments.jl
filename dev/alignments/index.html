<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Alignment representation · BioAlignments.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="BioAlignments.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">BioAlignments.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Alignment representation</a><ul class="internal"><li><a class="tocitem" href="#Overview-1"><span>Overview</span></a></li><li><a class="tocitem" href="#Representing-alignments-1"><span>Representing alignments</span></a></li><li><a class="tocitem" href="#Alignment-operations-1"><span>Alignment operations</span></a></li><li><a class="tocitem" href="#Aligned-sequences-1"><span>Aligned sequences</span></a></li></ul></li><li><a class="tocitem" href="../pairalign/">Pairwise alignment</a></li><li><a class="tocitem" href="../references/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Alignment representation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Alignment representation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/BioJulia/BioAlignments.jl/blob/1ea30c7b51170d95478921ea6e4a16e61d7c8b87/docs/src/alignments.md" title="View on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">View on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Alignment-representation-1"><a class="docs-heading-anchor" href="#Alignment-representation-1">Alignment representation</a><a class="docs-heading-anchor-permalink" href="#Alignment-representation-1" title="Permalink"></a></h1><h2 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h2><p>Types related to alignment representation introduced in this chapter are indispensable concepts to use this package. Specifically, <code>Alignment</code>, <code>AlignmentAnchor</code> and <code>Operation</code> are the most fundamental types of this package to represent an alignment of two sequences.</p><h2 id="Representing-alignments-1"><a class="docs-heading-anchor" href="#Representing-alignments-1">Representing alignments</a><a class="docs-heading-anchor-permalink" href="#Representing-alignments-1" title="Permalink"></a></h2><p>The <code>Alignment</code> type can represent a wide variety of global or local sequence alignments while facilitating efficient coordinate transformation.  Alignments are always relative to a possibly unspecified reference sequence and represent a series of <a href="https://en.wikipedia.org/wiki/Edit_distance">edit operations</a> performed on that reference to transform it to the query sequence. An edit operation is, for example, matching, insertion, or deletion.  All operations defined in BioAlignments.jl are described in the <a href="#Alignment-operations-1">Alignment operations</a> section.</p><p>To represent an alignment we use a series of &quot;anchors&quot; stored in the <code>AlignmentAnchor</code> type. Anchors are form of run-length encoding alignment operations, but rather than store an operation along with a length, we store the end-point of that operation in query (<code>seqpos</code>), reference (<code>refpos</code>) and alignment (<code>alnpos</code>) coordinates.</p><pre><code class="language-julia">struct AlignmentAnchor
    seqpos::Int
    refpos::Int
    alnpos::Int
    op::Operation
end</code></pre><p>The next figure shows a schematic representation of an alignment object.</p><p><img src="../assets/alignment.svg" alt="Alignment representation"/></p><p>Every alignment starts with a special <code>OP_START</code> operation which is used to give the position in the reference and query prior to the start of the alignment, or 0, if the alignment starts at position 1.</p><p>For example, consider the following alignment:</p><pre><code class="language-none">              0   4        9  12 15     19
              |   |        |  |  |      |
    query:     TGGC----ATCATTTAACG---CAAG
alignment:     ....----.....---...---....
reference: AGGGTGGCATTTATCAG---ACGTTTCGAGAC
              |   |   |    |     |  |   |
              4   8   12   17    20 23  27</code></pre><p>Using anchors we would represent this as the following series of anchors:</p><pre><code class="language-julia">[
    AlignmentAnchor( 0,  4,  0, OP_START),
    AlignmentAnchor( 4,  8,  4, OP_MATCH),
    AlignmentAnchor( 4, 12,  8, OP_DELETE),
    AlignmentAnchor( 9, 17, 13, OP_MATCH),
    AlignmentAnchor(12, 17, 16, OP_INSERT),
    AlignmentAnchor(15, 20, 19, OP_MATCH),
    AlignmentAnchor(15, 23, 22, OP_DELETE),
    AlignmentAnchor(19, 27, 26, OP_MATCH),
]</code></pre><p>An <code>Alignment</code> object can be created from a series of anchors:</p><pre><code class="language-julia-repl">julia&gt; Alignment([
           AlignmentAnchor(0,  4, 0, OP_START),
           AlignmentAnchor(4,  8, 4, OP_MATCH),
           AlignmentAnchor(4, 12, 8, OP_DELETE)
       ])
Alignment:
  aligned range:
    seq: 0-4
    ref: 4-12
  CIGAR string: 4M4D</code></pre><h2 id="Alignment-operations-1"><a class="docs-heading-anchor" href="#Alignment-operations-1">Alignment operations</a><a class="docs-heading-anchor-permalink" href="#Alignment-operations-1" title="Permalink"></a></h2><p>Alignment operations follow closely from those used in the <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM/BAM format</a> and are stored in the <code>Operation</code> bitstype.</p><table><tr><th style="text-align: left">Operation</th><th style="text-align: left">Operation Type</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>OP_MATCH</code></td><td style="text-align: left">match</td><td style="text-align: left">non-specific match</td></tr><tr><td style="text-align: left"><code>OP_INSERT</code></td><td style="text-align: left">insert</td><td style="text-align: left">insertion into reference sequence</td></tr><tr><td style="text-align: left"><code>OP_DELETE</code></td><td style="text-align: left">delete</td><td style="text-align: left">deletion from reference sequence</td></tr><tr><td style="text-align: left"><code>OP_SKIP</code></td><td style="text-align: left">delete</td><td style="text-align: left">(typically long) deletion from the reference, e.g. due to RNA splicing</td></tr><tr><td style="text-align: left"><code>OP_SOFT_CLIP</code></td><td style="text-align: left">insert</td><td style="text-align: left">sequence removed from the beginning or end of the query sequence but stored</td></tr><tr><td style="text-align: left"><code>OP_HARD_CLIP</code></td><td style="text-align: left">insert</td><td style="text-align: left">sequence removed from the beginning or end of the query sequence and not stored</td></tr><tr><td style="text-align: left"><code>OP_PAD</code></td><td style="text-align: left">special</td><td style="text-align: left">not currently supported, but present for SAM/BAM compatibility</td></tr><tr><td style="text-align: left"><code>OP_SEQ_MATCH</code></td><td style="text-align: left">match</td><td style="text-align: left">match operation with matching sequence positions</td></tr><tr><td style="text-align: left"><code>OP_SEQ_MISMATCH</code></td><td style="text-align: left">match</td><td style="text-align: left">match operation with mismatching sequence positions</td></tr><tr><td style="text-align: left"><code>OP_BACK</code></td><td style="text-align: left">special</td><td style="text-align: left">not currently supported, but present for SAM/BAM compatibility</td></tr><tr><td style="text-align: left"><code>OP_START</code></td><td style="text-align: left">special</td><td style="text-align: left">indicate the start of an alignment within the reference and query sequence</td></tr></table><p>Each operation has its own one-letter representation, which is the same as those defined in the SAM file format.</p><pre><code class="language-julia-repl">julia&gt; convert(Operation, &#39;M&#39;)  # Char =&gt; Operation
OP_MATCH

julia&gt; convert(Char, OP_MATCH)  # Operation =&gt; Char
&#39;M&#39;: ASCII/Unicode U+004D (category Lu: Letter, uppercase)

julia&gt; ismatchop(OP_MATCH)
true
</code></pre><p>See the <a href="../references/#Operations-1">Operations</a> section in the references for more details.</p><h2 id="Aligned-sequences-1"><a class="docs-heading-anchor" href="#Aligned-sequences-1">Aligned sequences</a><a class="docs-heading-anchor-permalink" href="#Aligned-sequences-1" title="Permalink"></a></h2><p>A sequence aligned to another sequence is represented by the <code>AlignedSequence</code> type, which is a pair of the aligned sequence and an <code>Alignment</code> object.</p><p>The following example creates an aligned sequence object from a sequence and an alignment:</p><pre><code class="language-julia-repl">julia&gt; AlignedSequence(  # pass an Alignment object
           dna&quot;ACGTAT&quot;,
           Alignment([
               AlignmentAnchor(0, 0, 0, OP_START),
               AlignmentAnchor(3, 3, 3, OP_MATCH),
               AlignmentAnchor(6, 3, 6, OP_INSERT)
           ])
       )
···---
ACGTAT

julia&gt; AlignedSequence(  # or pass a vector of anchors
           dna&quot;ACGTAT&quot;,
           [
               AlignmentAnchor(0, 0, 0, OP_START),
               AlignmentAnchor(3, 3, 3, OP_MATCH),
               AlignmentAnchor(6, 3, 6, OP_INSERT)
           ]
       )
···---
ACGTAT
</code></pre><p>If you already have an aligned sequence with gap symbols, it can be converted to an <code>AlignedSequence</code> object by passing a reference sequence with it:</p><pre><code class="language-jlcon">julia&gt; seq = dna&quot;ACGT--AAT--&quot;
11nt DNA Sequence:
ACGT--AAT--

julia&gt; ref = dna&quot;ACGTTTAT-GG&quot;
11nt DNA Sequence:
ACGTTTAT-GG

julia&gt; AlignedSequence(seq, ref)
········-··
ACGT--AAT--
</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../pairalign/">Pairwise alignment »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 1 July 2022 22:59">Friday 1 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
